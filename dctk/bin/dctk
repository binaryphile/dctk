#!/usr/bin/env bash

[[ -n $_dctk ]] && return
readonly _dctk=loaded

source kzn.bash
initialize_kzn

prog=${BASH_SOURCE##*/}
export _DCTK_PROG=$prog
source_path=$(realpath "$BASH_SOURCE")
source_path=$(dirname "$source_path")
# shellcheck disable=SC2140
eval export _"${prog^^}"_ROOT="$(absolute_path "$source_path"/../..)/$prog"
unset -v source_path

error_message="%s: no such command '%s'"

main() {
  local command=${1:-}
  local command_path
  local libexec

  libexec=$(realpath "$BASH_SOURCE")
  libexec=$(dirname "$libexec")
  libexec=$(absolute_path "$libexec"/../libexec)

  case $command in
    "" | "-h" | "--help" )
      exec "$libexec"/help
      ;;
    * )
      command_path=$libexec/$command
      # shellcheck disable=SC2059
      is_executable_file "$command_path" || errexit "$(printf "$error_message\n" "$prog" "$command")"
      shift
      exec "$command_path" "$@"
      ;;
  esac
}

return 0 2>/dev/null ||:

strict_mode on
main "$@"
