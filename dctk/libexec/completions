#!/usr/bin/env bash

source kaizen.bash all=1
$($bring 'dirname readlink' from kaizen.commands)

usage=$'usage: dctk completions COMMAND [arg1 arg2...]\n'

main () {
  command=$($dirname "$($readlink "$BASH_SOURCE")")/$1

  ! { script? "$command" && grep -qi "[#] completions: true" <<<"$(head "$command")" ;} && return
  shift
  exec "$command" --complete "$@"
}

script? () {
  [[ $(head --bytes=2 "$1") == "#!" ]]
}

$sourced? && return
$strict_mode on
echo
(( ! $# )) && $die "$usage"
main "$@"
