#!/usr/bin/env bash
# Usage: %s commands
# Summary: List all %s commands
# Help: This command is mostly used for autocompletion in various shells, and for `%s help`.

source kaizen.bash imports='array bring given? glob sourced? strict_mode'
$(bring '
  cd
  dirname
  echo
  readlink
' from kaizen.commands)

main () {
  local libexec

  libexec=$($dirname "$($readlink "$BASH_SOURCE")")
  list_commands "$libexec"
  $echo "$__"
}

list_commands () {
  __=$(
    $cd "$1"
    shopt -s nullglob
    glob *
    ! given? "$__" && return
    $(array files="$__")
    IFS=$'\n'
    uniq <<<"${files[*]}" | sort
  )
}

sourced? && return
strict_mode on
main "$@"
